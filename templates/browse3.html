{% extends "base.html" %}
{% block content %}

    {% set geocoded_locations = "[['Akaa','61.167742','23.867342'],['Alajärvi','63.000105','23.815926'],['Alavieska','64.165364','24.307758'],['Alavus','62.586451','23.618665'],['Asikkala','61.172136','25.547138'],['Askola','60.530441','25.597843'],['Aura','60.6467625','22.5737077'],['Brändö','60.412572','21.043594'],['Eckerö','60.223162','19.559538'],['Enonkoski','62.089337','28.916092'],['Enontekiö','68.383856','23.633262'],['Espoo','60.205491','24.6559'],['Eura','61.12958','22.130956'],['Eurajoki','61.202356','21.733985'],['Evijärvi','63.364066','23.486068'],['Finström','60.229913','19.988063'],['Forssa','60.814632','23.633947'],['Föglö','60.014608','20.41394'],['Geta','60.374953','19.847196'],['Haapajärvi','63.748662','25.318068'],['Haapavesi','64.137357','25.366942'],['Hailuoto','65.009529','24.715082'],['Halsua','63.463626','24.167344'],['Hamina','60.569337','27.187832'],['Hammarland','60.216399','19.74024'],['Hankasalmi','62.389441','26.436133'],['Hanko','59.834482','22.964781'],['Harjavalta','61.31371','22.141306'],['Hartola','61.5798327','26.0026703'],['Hattula','61.054972','24.37213'],['Hausjärvi','60.786474','25.027095'],['Heinola','61.210211','26.045755'],['Heinävesi','62.422804','28.631766'],['Helsinki','60.169856','24.938379'],['Hirvensalmi','61.642607','26.773174'],['Hollola','60.988702','25.516323'],['Honkajoki','61.9932','22.263729'],['Huittinen','61.176063','22.698071'],['Humppila','60.924226','23.371103'],['Hyrynsalmi','64.679145','28.48403'],['Hyvinkää','60.629952','24.85808'],['Hämeenkyrö','61.638326','23.196349'],['Hämeenlinna','60.992879','24.459024'],['Ii','65.312496','25.382927'],['Iisalmi','63.569424','27.182645'],['Iitti','60.936703','26.39962'],['Ikaalinen','61.771019','23.058658'],['Ilmajoki','62.73461','22.57087'],['Ilomantsi','62.667885','30.939491'],['Imatra','61.169598','28.764546'],['Inari','68.906204','27.027755'],['Inkoo','60.045875','24.004575'],['Isojoki','62.114067','21.95768'],['Isokyrö','62.999927','22.324465'],['Janakkala','60.920125','24.646002'],['Joensuu','62.601016','29.763572'],['Jokioinen','60.803843','23.485758'],['Jomala','60.152217','19.948617'],['Joroinen','62.179143','27.825877'],['Joutsa','61.742918','26.113721'],['Juuka','63.243277','29.254588'],['Juupajoki','61.796116','24.369975'],['Juva','61.894766','27.8442519'],['Jyväskylä','62.242603','25.747257'],['Jämijärvi','61.832757','22.622826'],['Jämsä','61.861982','25.180207'],['Järvenpää','60.474789','25.097105'],['Kaarina','60.409512','22.384126'],['Kaavi','62.974749','28.493305'],['Kajaani','64.222178','27.72785'],['Kalajoki','64.257862','23.947628'],['Kangasala','61.46921','24.039923'],['Kangasniemi','61.988095','26.641932'],['Kankaanpää','61.812654','22.375155'],['Kannonkoski','62.975794','25.261303'],['Kannus','63.900413','23.916745'],['Karijoki','62.307849','21.70688'],['Karkkila','60.535062','24.20929'],['Karstula','62.877764','24.800932'],['Karvia','62.133152','22.55812'],['Kaskinen','62.382283','21.227785'],['Kauhajoki','62.436333','22.187541'],['Kauhava','63.101197','23.065022'],['Kauniainen','60.211724','24.728878'],['Kaustinen','63.548093','23.696476'],['Keitele','63.17854','26.341232'],['Kemi','65.735568','24.565743'],['Kemijärvi','66.713628','27.429206'],['Keminmaa','65.80127','24.54504'],['Kemiönsaari','60.164872','22.727664'],['Kempele','64.912928','25.503484'],['Kerava','60.400988','25.102038'],['Keuruu','62.255985','24.707859'],['Kihniö','62.203001','23.176274'],['Kinnula','63.366435','24.967676'],['Kirkkonummi','60.123493','24.441297'],['Kitee','62.098438','30.138004'],['Kittilä','67.650732','24.91582'],['Kiuruvesi','63.653802','26.621055'],['Kivijärvi','63.119938','25.074712'],['Kokemäki','61.258344','22.353934'],['Kokkola','63.8415','23.125034'],['Kolari','67.3319482','23.7717627'],['Konnevesi','62.627766','26.293854'],['Kontiolahti','62.764338','29.847419'],['Korsnäs','62.784587','21.188686'],['Koski Tl','60.652148','23.138361'],['Kotka','60.466567','26.94594'],['Kouvola','60.867884','26.70416'],['Kristiinankaupunki','62.273935','21.37977'],['Kruunupyy','63.727997','23.033746'],['Kuhmo','64.128748','29.520283'],['Kuhmoinen','61.559174','25.164028'],['Kumlinge','60.258789','20.777989'],['Kuopio','62.89797','27.678172'],['Kuortane','62.806973','23.506884'],['Kurikka','62.617132','22.398705'],['Kustavi','60.544996','21.355343'],['Kuusamo','65.964588','29.188665'],['Kyyjärvi','63.043054','24.564922'],['Kärkölä','60.868878','25.27737'],['Kärsämäki','63.978585','25.758702'],['Kökar','59.920798','20.90913'],['Lahti','60.982675','25.66121'],['Laihia','62.976115','22.011472'],['Laitila','60.874216','21.698109'],['Lapinjärvi','60.619111','26.199924'],['Lapinlahti','63.366737','27.392157'],['Lappajärvi','63.224819','23.629909'],['Lappeenranta','61.054993','28.189663'],['Lapua','62.971972','23.002363'],['Laukaa','62.412677','25.94983'],['Lemi','61.0615864','27.7339312'],['Lemland','60.068851','20.086414'],['Lempäälä','61.314111','23.752448'],['Leppävirta','62.491705','27.788022'],['Lestijärvi','63.527237','24.658119'],['Lieksa','63.318505','30.026453'],['Lieto','60.500873','22.461275'],['Liminka','64.809831','25.415333'],['Liperi','62.529137','29.385364'],['Lohja','60.251176','24.067471'],['Loimaa','60.853533','23.042923'],['Loppi','60.717793','24.441732'],['Loviisa','60.457874','26.22781'],['Luhanka','61.796884','25.703551'],['Lumijoki','64.837341','25.18646'],['Lumparland','60.115216','20.262028'],['Luoto','63.752536','22.746187'],['Luumäki','60.922545','27.569314'],['Maalahti','62.945271','21.547698'],['Maarianhamina','60.097095','19.934834'],['Marttila','60.585476','22.897837'],['Masku','60.57081','22.101407'],['Merijärvi','64.297236','24.446531'],['Merikarvia','61.858299','21.500423'],['Miehikkälä','60.672207','27.701131'],['Mikkeli','61.688727','27.272146'],['Muhos','64.807538','25.994252'],['Multia','62.409256','24.800017'],['Muonio','67.955287','23.684092'],['Mustasaari','63.114061','21.68201'],['Muurame','62.129156','25.675877'],['Mynämäki','60.678479','21.988702'],['Myrskylä','60.669722','25.853678'],['Mäntsälä','60.663858','25.283605'],['Mänttä-Vilppula','62.03186','24.622967'],['Mäntyharju','61.417613','26.880512'],['Naantali','60.466088','22.025087'],['Nakkila','61.364836','22.005435'],['Nivala','63.9284484','24.9467351'],['Nokia','61.480309','23.501203'],['Nousiainen','60.598987','22.082434'],['Nurmes','63.541885','29.13957'],['Nurmijärvi','60.465499','24.807176'],['Närpiö','62.472839','21.337153'],['Orimattila','60.801713','25.72884'],['Oripää','60.856047','22.697304'],['Orivesi','61.67744','24.357408'],['Oulainen','64.267616','24.815948'],['Oulu','65.012089','25.465077'],['Outokumpu','62.720949','29.013615'],['Padasjoki','61.350938','25.278125'],['Paimio','60.456876','22.687026'],['Paltamo','64.403043','27.838147'],['Parainen','60.301082','22.302241'],['Parikkala','61.550187','29.502402'],['Parkano','62.011788','23.025499'],['Pedersören kunta','63.600693','22.796909'],['Pelkosenniemi','67.108368','27.514578'],['Pello','66.7762373','23.948681'],['Perho','63.244026','24.371045'],['Pertunmaa','61.507188','26.482116'],['Petäjävesi','62.257094','25.188353'],['Pieksämäki','62.294995','27.13305'],['Pielavesi','63.23245','26.755677'],['Pietarsaari','63.674404','22.696609'],['Pihtipudas','63.370609','25.575471'],['Pirkkala','61.466875','23.641537'],['Polvijärvi','62.855171','29.370486'],['Pomarkku','61.693474','22.008515'],['Pori','61.485139','21.797418'],['Pornainen','60.475844','25.374976'],['Porvoo','60.393192','25.665274'],['Posio','66.11059','28.167201'],['Pudasjärvi','65.361853','26.985855'],['Pukkila','60.645873','25.583103'],['Punkalaidun','61.11194','23.106107'],['Puolanka','64.867474','27.675203'],['Puumala','61.523852','28.177751'],['Pyhtää','60.492165','26.543057'],['Pyhäjoki','64.465053','24.262515'],['Pyhäjärvi','63.681199','25.981506'],['Pyhäntä','64.097101','26.330507'],['Pyhäranta','60.950156','21.444609'],['Pälkäne','61.337656','24.269088'],['Pöytyä','60.719832','22.603693'],['Raahe','64.683954','24.488365'],['Raasepori','59.974437','23.435507'],['Raisio','60.485912','22.168926'],['Rantasalmi','62.063996','28.302808'],['Ranua','65.929509','26.5159'],['Rauma','61.130885','21.505926'],['Rautalampi','62.624304','26.827749'],['Rautavaara','63.494184','28.298403'],['Rautjärvi','61.434571','29.371368'],['Reisjärvi','63.604521','24.938898'],['Riihimäki','60.737307','24.754852'],['Ristijärvi','64.505104','28.207121'],['Rovaniemi','66.503948','25.729391'],['Ruokolahti','61.2863','28.827514'],['Ruovesi','61.985214','24.071862'],['Rusko','60.5422151','22.204645'],['Rääkkylä','62.313841','29.623585'],['Saarijärvi','62.706698','25.255361'],['Salla','66.832652','28.670118'],['Salo','60.3898525','23.0936324'],['Saltvik','60.275525','20.061919'],['Sastamala','61.337603','22.918499'],['Sauvo','60.343472','22.695366'],['Savitaipale','61.197533','27.695863'],['Savonlinna','61.867973','28.886384'],['Savukoski','67.292419','28.158546'],['Seinäjoki','62.787735','22.850434'],['Sievi','63.906041','24.514451'],['Siikainen','61.87667','21.821576'],['Siikajoki','64.664547','25.102389'],['Siikalatva','64.268462','25.866827'],['Siilinjärvi','63.073683','27.661883'],['Simo','65.661403','25.057972'],['Sipoo','60.376754','25.268977'],['Siuntio','60.138582','24.226987'],['Sodankylä','67.415999','26.588973'],['Soini','62.873198','24.206374'],['Somero','60.628543','23.514525'],['Sonkajärvi','63.671639','27.522087'],['Sotkamo','64.130655','28.390498'],['Sottunga','60.130778','20.666582'],['Sulkava','61.7861','28.370586'],['Sund','60.2502746','20.1090108'],['Suomussalmi','64.884111','28.911656'],['Suonenjoki','62.626091','27.122123'],['Sysmä','61.50389','25.683206'],['Säkylä','61.054264','22.335348'],['Taipalsaari','61.152134','28.073948'],['Taivalkoski','65.57503','28.243419'],['Taivassalo','60.561612','21.613324'],['Tammela','60.80909','23.769003'],['Tampere','61.497752','23.760954'],['Tervo','62.956471','26.760424'],['Tervola','66.080502','24.810903'],['Teuva','62.480037','21.739208'],['Tohmajärvi','62.225171','30.335391'],['Toholampi','63.771611','24.247798'],['Toivakka','62.098003','26.081654'],['Tornio','65.847301','24.152024'],['Turku','60.451813','22.26663'],['Tuusniemi','62.810759','28.491238'],['Tuusula','60.404032','25.01306'],['Tyrnävä','64.763822','25.652994'],['Ulvila','61.430193','21.875001'],['Urjala','61.080306','23.548624'],['Utajärvi','64.762393','26.420563'],['Utsjoki','69.909047','27.028529'],['Uurainen','62.496888','25.441799'],['Uusikaarlepyy','63.52176','22.530356'],['Uusikaupunki','60.807601','21.402722'],['Vaala','64.559865','26.840908'],['Vaasa','63.095089','21.616456'],['Valkeakoski','61.271183','24.033327'],['Valtimo','63.678453','28.815616'],['Vantaa','60.293352','25.037769'],['Varkaus','62.324658','27.8961'],['Vehmaa','60.682143','21.705239'],['Vesanto','62.851634','26.416768'],['Vesilahti','61.309567','23.615767'],['Veteli','63.47993','23.786424'],['Vieremä','63.743086','27.001454'],['Vihti','60.416574','24.325638'],['Viitasaari','63.07342','25.85974'],['Vimpeli','63.164556','23.828237'],['Virolahti','60.582873','27.706898'],['Virrat','62.240905','23.770171'],['Vårdö','60.24232','20.37341'],['Vöyri','63.128554','22.250216'],['Ylitornio','66.319266','23.67097'],['Ylivieska','64.072342','24.533582'],['Ylöjärvi','61.549558','23.596098'],['Ypäjä','60.803753','23.281918'],['Ähtäri','62.550248','24.06941'],['Äänekoski','62.601466','25.727881']]" %}

    <experiment-index inline-template :common="{placeholders: placeholders}" api-url="${agitator_url}" language="${lang}" placeholder-image-url="/img/placeholder.png" show-limit="0" get-place="index">
        <div class="wrapper browse">

            <div class="large-12 columns">
                <h3 class="searchfield">${'Filter by keyword'|trans} | <a :href="rootUrl + '${lang}/haku/'">${'Back to browsing view'|trans}</a></h3>

                <div class="large-3 columns float-left">
                    <input @keyup="searchExperiments" v-model="searchTerm" type="text" class="form-control filter" placeholder="${'Type a keyword to search'|trans}">
                </div>
            </div>

            <experiment-map inline-template :experiments="sortExperiments(keywordFilter(sliceExperiments(filterByStage(filterById(experiments, showExperimentIds), 'all') , 0, showLimit), searchTerm))" google-maps-api-key="${google_maps_api_key}" :experiment-geocoded-locations="${geocoded_locations}" :map-center="{lat: 65, lng: 25}">
                <div class="row">
                    <div class="large-12 columns map-container">
                        <gmap-map :center="center" :zoom="5" :options="{streetViewControl: false}">
                            <gmap-marker :key="index" v-for="(m, index) in markers" :position="m.position" :title="m.title" @click="toggleInfoWindow(m, index)"></gmap-marker>
                            <gmap-info-window :options="infoOptions" :position="infoWindowPos" :opened="infoWinOpen" @closeclick="infoWinOpen=false">

                                <h3>{{infoName}}</h3>
                                <div v-for="experiment in infoContent" v-if="infoContent.length > 0">
                                    <a target="_parent" :href="rootUrl + '${lang}/experiment/' + experiment.id">
                                        <h4>{{ experiment.title }}</h4>
                                    </a>
                                    <p>{{ experiment.description }}</p>
                                </div>

                            </gmap-info-window>
                        </gmap-map>
                    </div>
                </div>
            </experiment-map>

        </div>
    </experiment-index>

{% endblock %}
